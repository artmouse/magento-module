<?xml version="1.0" encoding="UTF-8" ?>
<!--
/**
* @author Amasty Team
* @copyright Copyright (c) 2022 Amasty (https://www.amasty.com)
* @package Automatic Related Products MFTF 3 for Magento 2 (System)
*/-->
<actionGroups xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
              xsi:noNamespaceSchemaLocation="urn:magento:mftf:Test/etc/actionGroupSchema.xsd">
    <actionGroup name="AdminCreateRelProdRuleActionGroup">
        <arguments>
            <argument name="am_test_rule" defaultValue="amTestRelatedProductRule"/>
            <argument name="customerGroup" type="string" defaultValue="ALL GROUPS"/>
        </arguments>
        <amOnPage url="{{AdminRelatedProductRulesGridPage.url}}" stepKey="amOnRulesGridPageForCreate"/>
        <waitForElementVisible selector="{{AdminRuleGridActionSection.AddNewRuleButton}}"
                               stepKey="waitForAddRuleButtonVisible"/>
        <click selector="{{AdminRuleGridActionSection.AddNewRuleButton}}" stepKey="pressAddRuleButton"/>
        <waitForElementVisible selector="{{AdminNewRelatedProductRulesSection.relatedProductRuleName}}"
                               stepKey="waitForNewRuleFormVisible"/>
        <fillField selector="{{AdminNewRelatedProductRulesSection.relatedProductRuleName}}"
                   userInput="{{am_test_rule.rule_name}}" stepKey="fillFieldRuleName"/>
        <fillField selector="{{AdminNewRelatedProductRulesSection.relatedProductRulePriority}}"
                   userInput="{{am_test_rule.priority}}" stepKey="fillFieldPriority"/>
        <click selector="{{AdminNewRelatedProductRulesSection.allStoreViewSelect}}" stepKey="pressAllStoreViewSelect"/>
        <selectOption selector="{{AdminNewCatalogPriceRule.customerGroups}}" userInput="{{customerGroup}}"
                      stepKey="selectCustomerGroup"/>
        <click selector="{{AdminNewRelatedProductRulesSection.displaySettingsTab}}" stepKey="pressDisplaySettingsTab"/>
        <waitForElementVisible selector="{{AdminNewRelatedProductRulesSection.relatedBlockTitle}}"
                               stepKey="waitForNewRuleDisplaySettingsTabVisible"/>
        <fillField selector="{{AdminNewRelatedProductRulesSection.relatedBlockTitle}}"
                   userInput="{{am_test_rule.block_title}}" stepKey="fillFieldRelatedProductBlockTitle"/>
        <fillField selector="{{AdminNewRelatedProductRulesSection.maxProductsToDisplayField}}"
                   userInput="{{am_test_rule.max_products}}" stepKey="fillFieldMaxProductsToDisplay"/>
        <click selector="{{AdminMainActionsSection.saveAndContinue}}" stepKey="pressSaveNewRelatedProductRuleButton"/>
        <waitForElementVisible selector="{{AdminStoresGridSection.successMessage}}"
                               stepKey="waitForSuccessMessageVisible"/>
        <waitForAjaxLoad stepKey="waitForAjaxLoadAfterSave"/>
        <see selector="{{AdminStoresGridSection.successMessage}}"
             userInput="{{amastyARPMessage.rule_saved}}" stepKey="checkSaveRuleMessage"/>
    </actionGroup>
</actionGroups>

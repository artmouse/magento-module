<?xml version="1.0" encoding="UTF-8" ?>
<!--
/**
* @author Amasty Team
* @copyright Copyright (c) 2022 Amasty (https://www.amasty.com)
* @package Automatic Related Products MFTF 3 for Magento 2 (System)
*/-->
<actionGroups xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
              xsi:noNamespaceSchemaLocation="urn:magento:mftf:Test/etc/actionGroupSchema.xsd">
    <actionGroup name="AdminCreateRelProdRuleWhereToDisplayActionGroup">
        <arguments>
            <argument name="am_test_rule" defaultValue="amTestRelatedProductRule"/>
            <argument name="condition"/>
        </arguments>
        <amOnPage url="{{AdminRelatedProductRulesGridPage.url}}" stepKey="amOnRulesGridPageForCreate"/>
        <waitForElementVisible selector="{{AdminRuleGridActionSection.AddNewRuleButton}}"
                               stepKey="waitForAddRuleButtonVisible"/>
        <click selector="{{AdminRuleGridActionSection.AddNewRuleButton}}" stepKey="pressAddRuleButton"/>
        <waitForElementVisible selector="{{AdminNewRelatedProductRulesSection.relatedProductRuleName}}"
                               stepKey="waitForNewRuleFormVisible"/>
        <fillField selector="{{AdminNewRelatedProductRulesSection.relatedProductRuleName}}"
                   userInput="{{am_test_rule.rule_name}}" stepKey="fillFieldRuleName"/>
        <fillField selector="{{AdminNewRelatedProductRulesSection.relatedProductRulePriority}}"
                   userInput="{{am_test_rule.priority}}" stepKey="fillFieldPriority"/>
        <click selector="{{AdminNewRelatedProductRulesSection.whereToDisplayConditionTab}}"
               stepKey="pressToExpandWhereToDisplayConditionTabForNewParam"/>
        <waitForElementVisible selector="{{AdminNewRelatedProductRulesSection.newRuleParam}}"
                               stepKey="waitForNewRuleRuleParamElementVisible"/>
        <click selector="{{AdminNewRelatedProductRulesSection.newRuleParam}}"
               stepKey="pressToExpandWhereToDisplayConditionDropDown"/>
        <selectOption selector="{{AdminNewRelatedProductRulesSection.ruleConditionSelect}}" userInput="SKU"
               stepKey="pressToChangeWhereToDisplayCondition"/>
        <waitForAjaxLoad stepKey="waitForRuleFilterAjaxLoad"/>
        <click selector="{{AdminNewRelatedProductRulesSection.skuSelectButton}}"
               stepKey="pressToShowInputField"/>
        <fillField selector="{{AdminNewRelatedProductRulesSection.ruleConditionInput}}" userInput="{{condition}}"
                   stepKey="fillField"/>
        <click selector="{{AdminNewRelatedProductRulesSection.applyRuleParamButton}}"
               stepKey="pressToExpandWhereToDisplayConditionTab"/>
        <click selector="{{AdminNewRelatedProductRulesSection.allStoreViewSelect}}" stepKey="pressAllStoreViewSelect"/>
        <click selector="{{AdminNewRelatedProductRulesSection.displaySettingsTab}}" stepKey="pressDisplaySettingsTab"/>
        <waitForElementVisible selector="{{AdminNewRelatedProductRulesSection.relatedBlockTitle}}"
                               stepKey="waitForNewRuleDisplaySettingsTabVisible"/>
        <fillField selector="{{AdminNewRelatedProductRulesSection.relatedBlockTitle}}"
                   userInput="{{am_test_rule.block_title}}" stepKey="fillFieldRelatedProductBlockTitle"/>
        <click selector="{{AdminMainActionsSection.save}}" stepKey="pressSaveNewRelatedProductRuleButton"/>
        <waitForElementVisible selector="{{AdminStoresGridSection.successMessage}}"
                               stepKey="waitForSuccessMessageVisible"/>
        <see selector="{{AdminStoresGridSection.successMessage}}"
             userInput="{{amastyARPMessage.rule_saved}}" stepKey="checkSaveRuleMessage"/>
    </actionGroup>
</actionGroups>
